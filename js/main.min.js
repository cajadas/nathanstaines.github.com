(function(){"use strict";var e={likeCount:function(){var e=$("#likes"),t=e.find("span.count"),n=e.data("page-id"),r=!1,i="nathanstaines",s="likes",o="ZqUyD4bGcXktf9nj2A2Ixbt5IAMKWzKs",u;if(location.hostname.match("nathanstaines")&&e.length){var a=function(){var t=$(window).scrollTop();t=t>250?e.addClass("moveme"):e.removeClass("moveme")};$(window).scroll(function(){u&&clearTimeout(u);u=setTimeout(function(){a()},100)});if(localStorage&&localStorage.getItem(n)){var f=JSON.parse(localStorage.getItem(n));f.counted&&e.addClass("counted").find("i").toggleClass("icon-heart-empty icon-heart-full")}if(sessionStorage&&sessionStorage.getItem(n)){var l=JSON.parse(sessionStorage.getItem(n));t.text(l.count)}else $.ajax({url:"https://api.mongolab.com/api/1/databases/"+i+"/collections/"+s+"?apiKey="+o,type:"GET",contentType:"application/json",success:function(e){$.each(e,function(e,i){if(i.pageId===n){t.text(i.count);r=!0}sessionStorage.setItem(i.pageId,JSON.stringify({count:i.count}))});r||$.ajax({url:"https://api.mongolab.com/api/1/databases/"+i+"/collections/"+s+"?apiKey="+o,data:JSON.stringify({pageId:n,count:0}),type:"POST",contentType:"application/json",success:function(){t.text("0");sessionStorage.setItem(n,JSON.stringify({count:0}))}})}});e.on("click",function(e){var r=$(this),u=t.text();r.toggleClass("counted").find("i").toggleClass("icon-heart-empty icon-heart-full");u=r.hasClass("counted")?++u:--u;t.text(u);sessionStorage.setItem(n,JSON.stringify({count:u}));localStorage.setItem(n,JSON.stringify({counted:r.hasClass("counted")?!0:!1}));$.ajax({url:"https://api.mongolab.com/api/1/databases/"+i+"/runCommand?apiKey="+o,data:JSON.stringify({findAndModify:s,query:{pageId:n},update:{$inc:{count:r.hasClass("counted")?1:-1}},upsert:!0}),type:"POST",contentType:"application/json"});e.preventDefault()})}},bannerImage:function(){function i(){n=e.find("img").height();t=e.height();r=(t-n)/2;e.find("img").css("margin-top",r<=0?r:0);e.removeClass("hidden")}var e=$(".banner"),t,n,r;$(window).on("load resize",i);document.addEventListener("orientationchange",i)}};$(function(){e.likeCount();e.bannerImage()})})();